<div class="container">
    <div class="section-header">
        <h1>Books on Shelf</h1>
        <button class="add-btn" (click)="onAddBook()">Add</button>
    </div>

    <!-- Loading State -->
    @if (isLoading) {
    <div style="text-align: center; padding: 2rem;">
        <p>Loading books...</p>
    </div>
    }

    <!-- Error Message -->
    @if (errorMessage && !isLoading) {
    <div class="alert alert-error">
        {{ errorMessage }}
    </div>
    }

    @if (!isLoading && !errorMessage) {
    <div class="grid-header">
        <div class="grid-header-item">Title & Author</div>
        <div class="grid-header-item">Available Copies</div>
        <div class="grid-header-item">ISBN</div>
        <div class="grid-header-item">Publisher Year</div>
        <div class="grid-header-item">Status</div>
        <div class="grid-header-item">Actions</div>
    </div>

    @for (book of filteredBooks; track book.id) {
    <div class="grid-row">
        <div class="book-info">
            <img [src]="getImageUrl(book.img)" 
                 [alt]="book.title" 
                 class="book-cover"
                 (error)="book.img = 'assets/default-book-cover.jpg'">
            <div class="book-details">
                <h3>{{ book.title }}</h3>
                <p>{{ book.author }}</p>
            </div>
        </div>
        <div class="grid-cell copies-cell">
            <span class="copies-count">{{ book.available_copies }}</span>
            <span class="copies-label">available</span>
        </div>
        <div class="grid-cell">{{ book.ISBN }}</div>
        <div class="grid-cell">{{ book.publishYear }}</div>
        <div class="grid-cell">
            <span class="status-badge" [class.status-available]="book.available_copies > 0" [class.status-unavailable]="book.available_copies === 0">
                {{ book.available_copies > 0 ? 'Available' : 'Unavailable' }}
            </span>
        </div>
        <div class="actions">
            <button class="btn btn-update" (click)="onUpdate(book)">Update</button>
            <button class="btn btn-delete" (click)="onDelete(book)">Delete</button>
        </div>
    </div>
    }

    @if (filteredBooks.length === 0 && !isLoading) {
    <div class="no-results">
        <p>No books found matching "{{ searchQuery }}"</p>
    </div>
    }
    }
</div>